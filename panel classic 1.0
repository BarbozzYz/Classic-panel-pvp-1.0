--[[
    ╔══════════════════════════════════════════╗
    ║   PANEL PVP CLASSIC MENU 1.0            ║
    ║   VERSÃO FINAL - TUDO CORRIGIDO         ║
    ╚══════════════════════════════════════════╝
]]

-- Serviços
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local StarterGui = game:GetService("StarterGui")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera
local Mouse = LocalPlayer:GetMouse()

-- Notificação
StarterGui:SetCore("SendNotification", {
    Title = "CLASSIC PANEL PVP";
    Text = "✅ The best script was executed successfully!";
    Duration = 5;
})

-- Configurações
local Settings = {
    Combat = {
        Aimbot = false,
        AimbotType = "Ao mirar",
        AimbotKey = Enum.UserInputType.MouseButton2,
        FOV = false,
        FOVSize = 150,
        Hitbox = false,
        HitboxSize = 15,
        NoRecoil = false,
        NoHit = false
    },
    ESP = {
        Enabled = false,
        Team = false,
        Chams = false,
        ChamsTeam = false,
        ChamsSkin = false,
        Health = false,
        Name = false,
        Meters = false,
        Line = false,
        LinePlacement = "Top",
        Box = false
    },
    Colors = {
        General = Color3.fromRGB(255, 255, 255),
        GeneralR = 255,
        GeneralG = 255,
        GeneralB = 255,
        PanelOnly = Color3.fromRGB(255, 255, 255),
        PanelR = 255,
        PanelG = 255,
        PanelB = 255
    },
    Various = {
        NoClip = false,
        WalkSpeed = 16,
        JumpPower = 50,
        Fly = false,
        FlySpeed = 50,
        Macro = false,
        MacroSpeed = 0.05
    },
    SessionTime = 0
}

-- Variáveis Globais
local ESPObjects = {}
local FOVCircle = nil
local NoHitPart = nil
local FlyBodyVelocity = nil
local FlyBodyGyro = nil
local MacroConnection = nil
local AimbotConnection = nil
local NoClipConnection = nil
local WalkSpeedConnection = nil
local JumpPowerConnection = nil
local OriginalHitboxSizes = {}
local CurrentTarget = nil
local GUI = nil
local TeleportPoints = {} -- Pontos de teleporte salvos

-- Dash Key
_G.DashKey = Enum.KeyCode.Q

-- Função DASH
local function PerformDash()
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        local hrp = LocalPlayer.Character.HumanoidRootPart
        local humanoid = LocalPlayer.Character:FindFirstChild("Humanoid")
        
        if humanoid then
            -- Salvar CanCollide original de todas as partes
            local originalCollisions = {}
            for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
                if part:IsA("BasePart") then
                    originalCollisions[part] = part.CanCollide
                    part.CanCollide = false
                end
            end
            
            -- Dash na direção da câmera (pequeno)
            local dashDirection = Camera.CFrame.LookVector
            local dashDistance = 15 -- Distância pequena
            
            hrp.CFrame = hrp.CFrame + (dashDirection * dashDistance)
            
            -- Aguardar um pouco e restaurar colisões
            task.wait(0.1)
            for part, collision in pairs(originalCollisions) do
                if part and part.Parent then
                    part.CanCollide = collision
                end
            end
        end
    end
end

-- Função de proteção
local function safeCall(func)
    local success, err = pcall(func)
    if not success then
        warn("⚠️ Erro:", err)
    end
    return success
end

-- FUNÇÃO PARA APLICAR COR GERAL (Labels + FOV + TODOS os ESPs)
local function ApplyGeneralColor(color)
    if not GUI then return end
    
    -- Aplicar em TODOS os textos do menu
    for _, obj in pairs(GUI:GetDescendants()) do
        if obj:IsA("TextLabel") or obj:IsA("TextButton") then
            if obj.Name ~= "Title" then -- Exceto título
                obj.TextColor3 = color
            end
        end
    end
    
    -- Atualizar cor do FOV Circle
    if FOVCircle then
        FOVCircle.Color = Color3.new(color.R, color.G, color.B)
    end
    
    -- Atualizar cor de TODOS os ESPs ativos
    for player, espData in pairs(ESPObjects) do
        if espData then
            -- Highlight
            if espData.Highlight and not Settings.ESP.Team then
                espData.Highlight.FillColor = color
                espData.Highlight.OutlineColor = color
            end
            
            -- Line
            if espData.Line then
                espData.Line.Color = Color3.new(color.R, color.G, color.B)
            end
            
            -- Box
            if espData.Box then
                espData.Box.Color = Color3.new(color.R, color.G, color.B)
            end
            
            -- Chams
            if espData.Chams and not Settings.ESP.ChamsTeam then
                for _, box in pairs(espData.Chams) do
                    box.Color3 = color
                end
            end
        end
    end
end

local function ApplyPanelOnlyColor(color)
    if not GUI then return end
    
    -- Aplicar APENAS em textos (não em backgrounds)
    for _, obj in pairs(GUI:GetDescendants()) do
        if obj:IsA("TextLabel") or obj:IsA("TextButton") then
            if obj.Name ~= "Title" then
                obj.TextColor3 = color
            end
        end
        if obj:IsA("UIStroke") then
            obj.Color = color
        end
    end
end

-- ============================================
-- SISTEMAS FUNCIONAIS
-- ============================================

-- AIMBOT FUNCIONAL
local function GetClosestPlayerToCursor()
    if not Settings.Combat.Aimbot then return nil end
    
    local closestPlayer = nil
    local shortestDistance = Settings.Combat.FOVSize
    
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("Head") then
            local head = player.Character.Head
            local screenPoint, onScreen = Camera:WorldToViewportPoint(head.Position)
            
            if onScreen then
                local mouseLocation = UserInputService:GetMouseLocation()
                local distance = (Vector2.new(screenPoint.X, screenPoint.Y) - mouseLocation).Magnitude
                
                if distance < shortestDistance then
                    closestPlayer = player
                    shortestDistance = distance
                end
            end
        end
    end
    
    return closestPlayer
end

local function UpdateAimbot()
    if Settings.Combat.Aimbot then
        local isAiming = false
        
        if Settings.Combat.AimbotType == "Ao mirar" then
            isAiming = UserInputService:IsMouseButtonPressed(Enum.UserInputType.MouseButton2)
        elseif Settings.Combat.AimbotType == "ToggleKey" then
            -- Verificar se é tecla do teclado ou botão do mouse
            if typeof(Settings.Combat.AimbotKey) == "EnumItem" then
                if Settings.Combat.AimbotKey.EnumType == Enum.KeyCode then
                    -- É uma tecla do teclado
                    isAiming = UserInputService:IsKeyDown(Settings.Combat.AimbotKey)
                elseif Settings.Combat.AimbotKey.EnumType == Enum.UserInputType then
                    -- É um botão do mouse
                    isAiming = UserInputService:IsMouseButtonPressed(Settings.Combat.AimbotKey)
                end
            end
        end
        
        if isAiming then
            CurrentTarget = GetClosestPlayerToCursor()
            if CurrentTarget and CurrentTarget.Character and CurrentTarget.Character:FindFirstChild("Head") then
                Camera.CFrame = CFrame.new(Camera.CFrame.Position, CurrentTarget.Character.Head.Position)
            end
        end
    end
end

-- HITBOX FUNCIONAL
local function ApplyHitbox()
    safeCall(function()
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer and player.Character then
                local hrp = player.Character:FindFirstChild("HumanoidRootPart")
                
                if hrp then
                    if Settings.Combat.Hitbox then
                        if not OriginalHitboxSizes[hrp] then
                            OriginalHitboxSizes[hrp] = hrp.Size
                        end
                        
                        hrp.Size = Vector3.new(Settings.Combat.HitboxSize, Settings.Combat.HitboxSize, Settings.Combat.HitboxSize)
                        hrp.Transparency = 0.7
                        hrp.Color = Color3.fromRGB(255, 0, 0)
                        hrp.Material = Enum.Material.Neon
                        hrp.CanCollide = false
                    else
                        if OriginalHitboxSizes[hrp] then
                            hrp.Size = OriginalHitboxSizes[hrp]
                            hrp.Transparency = 1
                            hrp.CanCollide = false
                        end
                    end
                end
            end
        end
    end)
end

-- NO RECOIL FUNCIONAL
local function ApplyNoRecoil()
    safeCall(function()
        if not Settings.Combat.NoRecoil then return end
        
        if LocalPlayer.Character then
            for _, tool in pairs(LocalPlayer.Character:GetChildren()) do
                if tool:IsA("Tool") then
                    for _, obj in pairs(tool:GetDescendants()) do
                        if obj:IsA("NumberValue") then
                            local name = obj.Name:lower()
                            if name:find("recoil") or name:find("spread") or name:find("kickback") then
                                obj.Value = 0
                            end
                        end
                    end
                end
            end
        end
        
        if LocalPlayer.Backpack then
            for _, tool in pairs(LocalPlayer.Backpack:GetChildren()) do
                if tool:IsA("Tool") then
                    for _, obj in pairs(tool:GetDescendants()) do
                        if obj:IsA("NumberValue") then
                            local name = obj.Name:lower()
                            if name:find("recoil") or name:find("spread") or name:find("kickback") then
                                obj.Value = 0
                            end
                        end
                    end
                end
            end
        end
    end)
end

-- ESP FUNCIONAL COM TUDO CORRIGIDO
local function CreateESP(player)
    if player == LocalPlayer then return end
    
    -- Limpar ESP antigo se existir
    if ESPObjects[player] then
        for _, obj in pairs(ESPObjects[player]) do
            if obj then
                if typeof(obj) == "Instance" then
                    obj:Destroy()
                elseif typeof(obj) == "table" then
                    if obj.Remove then obj:Remove() end
                    if obj.Billboard then obj.Billboard:Destroy() end
                end
            end
        end
        ESPObjects[player] = nil
    end
    
    local function UpdateESP()
        safeCall(function()
            if not player.Parent or not player.Character then 
                -- Limpar se player saiu
                if ESPObjects[player] then
                    for _, obj in pairs(ESPObjects[player]) do
                        if obj then
                            if typeof(obj) == "Instance" then
                                obj:Destroy()
                            elseif typeof(obj) == "table" then
                                if obj.Remove then obj:Remove() end
                                if obj.Billboard then obj.Billboard:Destroy() end
                            end
                        end
                    end
                    ESPObjects[player] = nil
                end
                return 
            end
            
            ESPObjects[player] = ESPObjects[player] or {}
            
            -- Highlight ESP
            if Settings.ESP.Enabled then
                if not ESPObjects[player].Highlight then
                    local highlight = Instance.new("Highlight")
                    highlight.Adornee = player.Character
                    highlight.FillTransparency = 0.5
                    highlight.OutlineTransparency = 0
                    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
                    highlight.Parent = player.Character
                    ESPObjects[player].Highlight = highlight
                end
                
                -- Aplicar cor
                if Settings.ESP.Team and player.Team then
                    ESPObjects[player].Highlight.FillColor = player.Team.TeamColor.Color
                    ESPObjects[player].Highlight.OutlineColor = player.Team.TeamColor.Color
                else
                    ESPObjects[player].Highlight.FillColor = Settings.Colors.General
                    ESPObjects[player].Highlight.OutlineColor = Settings.Colors.General
                end
            else
                if ESPObjects[player].Highlight then
                    ESPObjects[player].Highlight:Destroy()
                    ESPObjects[player].Highlight = nil
                end
            end
            
            -- ESP HEALTH BAR VERTICAL (Tamanho do Personagem)
            if Settings.ESP.Health and player.Character:FindFirstChild("HumanoidRootPart") and player.Character:FindFirstChild("Humanoid") then
                if not ESPObjects[player].HealthBar then
                    local billboard = Instance.new("BillboardGui")
                    billboard.Adornee = player.Character.HumanoidRootPart
                    billboard.Size = UDim2.new(0, 4, 6, 0) -- ALTURA FIXA (6 studs = tamanho do personagem)
                    billboard.StudsOffset = Vector3.new(-3, 0, 0)
                    billboard.AlwaysOnTop = true
                    billboard.Parent = player.Character.HumanoidRootPart
                    
                    local frame = Instance.new("Frame")
                    frame.Size = UDim2.new(1, 0, 1, 0)
                    frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
                    frame.BorderSizePixel = 1
                    frame.BorderColor3 = Color3.fromRGB(0, 0, 0)
                    frame.Parent = billboard
                    
                    local bar = Instance.new("Frame")
                    bar.Size = UDim2.new(1, 0, 1, 0)
                    bar.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
                    bar.BorderSizePixel = 0
                    bar.Parent = frame
                    
                    ESPObjects[player].HealthBar = {Billboard = billboard, Bar = bar}
                end
                
                local humanoid = player.Character.Humanoid
                local healthPercent = humanoid.Health / humanoid.MaxHealth
                
                -- Atualizar tamanho da barra verticalmente (de baixo para cima)
                ESPObjects[player].HealthBar.Bar.Size = UDim2.new(1, 0, healthPercent, 0)
                ESPObjects[player].HealthBar.Bar.Position = UDim2.new(0, 0, 1 - healthPercent, 0)
                
                -- Cores baseadas na vida
                if healthPercent > 0.75 then
                    ESPObjects[player].HealthBar.Bar.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
                elseif healthPercent > 0.5 then
                    ESPObjects[player].HealthBar.Bar.BackgroundColor3 = Color3.fromRGB(255, 255, 0)
                elseif healthPercent > 0.25 then
                    ESPObjects[player].HealthBar.Bar.BackgroundColor3 = Color3.fromRGB(255, 165, 0)
                else
                    ESPObjects[player].HealthBar.Bar.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
                end
            elseif not Settings.ESP.Health and ESPObjects[player].HealthBar then
                ESPObjects[player].HealthBar.Billboard:Destroy()
                ESPObjects[player].HealthBar = nil
            end
            
            -- ESP Name
            if Settings.ESP.Name and player.Character:FindFirstChild("Head") then
                if not ESPObjects[player].Name then
                    local billboard = Instance.new("BillboardGui")
                    billboard.Adornee = player.Character.Head
                    billboard.Size = UDim2.new(0, 200, 0, 50)
                    billboard.StudsOffset = Vector3.new(0, 2, 0)
                    billboard.AlwaysOnTop = true
                    billboard.Parent = player.Character.Head
                    
                    local label = Instance.new("TextLabel")
                    label.Size = UDim2.new(1, 0, 1, 0)
                    label.BackgroundTransparency = 1
                    label.Text = player.Name
                    label.TextColor3 = Color3.fromRGB(255, 255, 255)
                    label.Font = Enum.Font.SourceSansBold
                    label.TextSize = 16
                    label.TextStrokeTransparency = 0
                    label.Parent = billboard
                    
                    ESPObjects[player].Name = billboard
                end
            elseif not Settings.ESP.Name and ESPObjects[player].Name then
                ESPObjects[player].Name:Destroy()
                ESPObjects[player].Name = nil
            end
            
            -- ESP Meters
            if Settings.ESP.Meters and player.Character:FindFirstChild("Head") and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                if not ESPObjects[player].Meters then
                    local billboard = Instance.new("BillboardGui")
                    billboard.Adornee = player.Character.Head
                    billboard.Size = UDim2.new(0, 200, 0, 50)
                    billboard.StudsOffset = Vector3.new(0, 3, 0)
                    billboard.AlwaysOnTop = true
                    billboard.Parent = player.Character.Head
                    
                    local label = Instance.new("TextLabel")
                    label.Size = UDim2.new(1, 0, 1, 0)
                    label.BackgroundTransparency = 1
                    label.TextColor3 = Color3.fromRGB(255, 255, 255)
                    label.Font = Enum.Font.SourceSansBold
                    label.TextSize = 14
                    label.TextStrokeTransparency = 0
                    label.Parent = billboard
                    
                    ESPObjects[player].Meters = label
                end
                
                local distance = (player.Character.HumanoidRootPart.Position - LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
                ESPObjects[player].Meters.Text = string.format("%.0fm", distance)
            elseif not Settings.ESP.Meters and ESPObjects[player].Meters then
                ESPObjects[player].Meters.Parent:Destroy()
                ESPObjects[player].Meters = nil
            end
            
            -- ESP Line
            if Settings.ESP.Line and player.Character:FindFirstChild("HumanoidRootPart") then
                if not ESPObjects[player].Line then
                    local line = Drawing.new("Line")
                    line.Visible = true
                    line.Thickness = 1
                    line.Transparency = 1
                    ESPObjects[player].Line = line
                end
                
                local hrp = player.Character.HumanoidRootPart
                local screenPos, onScreen = Camera:WorldToViewportPoint(hrp.Position)
                
                if onScreen then
                    local startY = Settings.ESP.LinePlacement == "Top" and 0 or Camera.ViewportSize.Y
                    ESPObjects[player].Line.From = Vector2.new(Camera.ViewportSize.X / 2, startY)
                    ESPObjects[player].Line.To = Vector2.new(screenPos.X, screenPos.Y)
                    ESPObjects[player].Line.Color = Color3.new(Settings.Colors.General.R, Settings.Colors.General.G, Settings.Colors.General.B)
                    ESPObjects[player].Line.Visible = true
                else
                    ESPObjects[player].Line.Visible = false
                end
            elseif not Settings.ESP.Line and ESPObjects[player].Line then
                ESPObjects[player].Line:Remove()
                ESPObjects[player].Line = nil
            end
            
            -- ESP Box
            if Settings.ESP.Box and player.Character:FindFirstChild("HumanoidRootPart") then
                if not ESPObjects[player].Box then
                    local box = Drawing.new("Square")
                    box.Visible = true
                    box.Thickness = 1
                    box.Transparency = 1
                    box.Filled = false
                    ESPObjects[player].Box = box
                end
                
                local hrp = player.Character.HumanoidRootPart
                local screenPos, onScreen = Camera:WorldToViewportPoint(hrp.Position)
                
                if onScreen then
                    local topPos = Camera:WorldToViewportPoint((hrp.CFrame * CFrame.new(0, 3, 0)).Position)
                    local bottomPos = Camera:WorldToViewportPoint((hrp.CFrame * CFrame.new(0, -3, 0)).Position)
                    
                    local height = math.abs(topPos.Y - bottomPos.Y)
                    local width = height / 2
                    
                    ESPObjects[player].Box.Size = Vector2.new(width, height)
                    ESPObjects[player].Box.Position = Vector2.new(screenPos.X - width / 2, screenPos.Y - height / 2)
                    ESPObjects[player].Box.Color = Color3.new(Settings.Colors.General.R, Settings.Colors.General.G, Settings.Colors.General.B)
                    ESPObjects[player].Box.Visible = true
                else
                    ESPObjects[player].Box.Visible = false
                end
            elseif not Settings.ESP.Box and ESPObjects[player].Box then
                ESPObjects[player].Box:Remove()
                ESPObjects[player].Box = nil
            end
            
            -- Chams (BoxHandleAdornment)
            if Settings.ESP.Chams and player.Character then
                if not ESPObjects[player].Chams then
                    ESPObjects[player].Chams = {}
                    
                    for _, part in pairs(player.Character:GetDescendants()) do
                        if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                            local box = Instance.new("BoxHandleAdornment")
                            box.Size = part.Size
                            box.Adornee = part
                            box.AlwaysOnTop = true
                            box.ZIndex = 10
                            box.Transparency = 0.5
                            box.Parent = part
                            
                            table.insert(ESPObjects[player].Chams, box)
                        end
                    end
                end
                
                -- Aplicar cor
                for _, box in pairs(ESPObjects[player].Chams) do
                    if Settings.ESP.ChamsTeam and player.Team then
                        box.Color3 = player.Team.TeamColor.Color
                    else
                        box.Color3 = Settings.Colors.General
                    end
                end
            elseif not Settings.ESP.Chams and ESPObjects[player].Chams then
                for _, box in pairs(ESPObjects[player].Chams) do
                    box:Destroy()
                end
                ESPObjects[player].Chams = nil
            end
            
            -- CHAMS SKIN (Player visível através das paredes com skin)
            if Settings.ESP.ChamsSkin and player.Character then
                if not ESPObjects[player].ChamsSkin then
                    ESPObjects[player].ChamsSkin = {}
                    
                    -- Processar TODAS as partes do character
                    for _, part in pairs(player.Character:GetDescendants()) do
                        -- Para BaseParts (partes do corpo)
                        if part:IsA("BasePart") then
                            -- Criar Highlight individual para cada parte
                            local highlight = Instance.new("Highlight")
                            highlight.Adornee = part
                            highlight.FillTransparency = 1 -- Totalmente transparente (mostra a skin)
                            highlight.OutlineTransparency = 1 -- Sem contorno
                            highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
                            highlight.Parent = part
                            
                            table.insert(ESPObjects[player].ChamsSkin, highlight)
                        end
                        
                        -- Para acessórios/roupas (MeshParts, Parts com texturas)
                        if part:IsA("MeshPart") or part:IsA("Part") then
                            -- Criar clone visual que sempre aparece
                            if part:FindFirstChildOfClass("SpecialMesh") or part:FindFirstChildOfClass("Decal") then
                                local highlight = Instance.new("Highlight")
                                highlight.Adornee = part
                                highlight.FillTransparency = 1
                                highlight.OutlineTransparency = 1
                                highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
                                highlight.Parent = part
                                
                                table.insert(ESPObjects[player].ChamsSkin, highlight)
                            end
                        end
                        
                        -- Para Decals (rostos, etc)
                        if part:IsA("Decal") then
                            -- Salvar transparência original
                            if not ESPObjects[player].ChamsSkin[part] then
                                ESPObjects[player].ChamsSkin[part] = part.Transparency
                            end
                        end
                    end
                    
                    -- Aplicar renderização especial em TODAS as partes
                    for _, part in pairs(player.Character:GetDescendants()) do
                        if part:IsA("BasePart") or part:IsA("MeshPart") then
                            -- Forçar renderização através das paredes
                            part.LocalTransparencyModifier = 0
                            
                            -- Se tiver material/textura, manter visível
                            if part:IsA("MeshPart") then
                                -- MeshParts mantêm suas texturas
                                local originalMaterial = part.Material
                                part.Material = originalMaterial
                            end
                        end
                    end
                end
                
                -- Atualizar continuamente para garantir visibilidade
                for _, part in pairs(player.Character:GetDescendants()) do
                    if part:IsA("BasePart") or part:IsA("MeshPart") then
                        part.LocalTransparencyModifier = 0
                    end
                end
                
            elseif not Settings.ESP.ChamsSkin and ESPObjects[player].ChamsSkin then
                -- Limpar highlights
                for i, highlight in pairs(ESPObjects[player].ChamsSkin) do
                    if typeof(highlight) == "Instance" and highlight:IsA("Highlight") then
                        highlight:Destroy()
                    end
                end
                
                -- Restaurar LocalTransparencyModifier
                for _, part in pairs(player.Character:GetDescendants()) do
                    if part:IsA("BasePart") or part:IsA("MeshPart") then
                        part.LocalTransparencyModifier = 1
                    end
                end
                
                ESPObjects[player].ChamsSkin = nil
            end
        end)
    end
    
    -- Conectar ao CharacterAdded para aplicar ESP quando player renascer
    player.CharacterAdded:Connect(function(character)
        task.wait(0.3) -- Aguardar character carregar
        -- Limpar ESP antigo
        if ESPObjects[player] then
            for _, obj in pairs(ESPObjects[player]) do
                if obj then
                    if typeof(obj) == "Instance" then
                        obj:Destroy()
                    elseif typeof(obj) == "table" then
                        if obj.Remove then obj:Remove() end
                        if obj.Billboard then obj.Billboard:Destroy() end
                    end
                end
            end
            ESPObjects[player] = nil
        end
        UpdateESP()
    end)
    
    -- Atualizar ESP continuamente
    RunService.RenderStepped:Connect(UpdateESP)
end

-- FLY FUNCIONAL
local function ToggleFly(state)
    if state then
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            local hrp = LocalPlayer.Character.HumanoidRootPart
            
            FlyBodyVelocity = Instance.new("BodyVelocity")
            FlyBodyVelocity.MaxForce = Vector3.new(9e9, 9e9, 9e9)
            FlyBodyVelocity.Velocity = Vector3.new(0, 0, 0)
            FlyBodyVelocity.Parent = hrp
            
            FlyBodyGyro = Instance.new("BodyGyro")
            FlyBodyGyro.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
            FlyBodyGyro.P = 9e9
            FlyBodyGyro.CFrame = hrp.CFrame
            FlyBodyGyro.Parent = hrp
            
            RunService.RenderStepped:Connect(function()
                if Settings.Various.Fly and FlyBodyVelocity and FlyBodyGyro then
                    local cam = workspace.CurrentCamera
                    local velocity = Vector3.new(0, 0, 0)
                    
                    if UserInputService:IsKeyDown(Enum.KeyCode.W) then
                        velocity = velocity + (cam.CFrame.LookVector * Settings.Various.FlySpeed)
                    end
                    if UserInputService:IsKeyDown(Enum.KeyCode.S) then
                        velocity = velocity - (cam.CFrame.LookVector * Settings.Various.FlySpeed)
                    end
                    if UserInputService:IsKeyDown(Enum.KeyCode.A) then
                        velocity = velocity - (cam.CFrame.RightVector * Settings.Various.FlySpeed)
                    end
                    if UserInputService:IsKeyDown(Enum.KeyCode.D) then
                        velocity = velocity + (cam.CFrame.RightVector * Settings.Various.FlySpeed)
                    end
                    if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
                        velocity = velocity + Vector3.new(0, Settings.Various.FlySpeed, 0)
                    end
                    if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then
                        velocity = velocity - Vector3.new(0, Settings.Various.FlySpeed, 0)
                    end
                    
                    FlyBodyVelocity.Velocity = velocity
                    FlyBodyGyro.CFrame = cam.CFrame
                end
            end)
        end
    else
        if FlyBodyVelocity then
            FlyBodyVelocity:Destroy()
            FlyBodyVelocity = nil
        end
        if FlyBodyGyro then
            FlyBodyGyro:Destroy()
            FlyBodyGyro = nil
        end
    end
end

-- MACRO FUNCIONAL
local function ToggleMacro(state)
    if state then
        MacroConnection = RunService.Heartbeat:Connect(function()
            if Settings.Various.Macro and LocalPlayer.Backpack then
                local toolCount = #LocalPlayer.Backpack:GetChildren()
                for i = 1, math.min(toolCount, 9) do
                    task.wait(Settings.Various.MacroSpeed)
                    local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid")
                    if humanoid then
                        local tool = LocalPlayer.Backpack:FindFirstChildOfClass("Tool")
                        if tool then
                            humanoid:EquipTool(tool)
                        end
                    end
                end
            end
        end)
    else
        if MacroConnection then
            MacroConnection:Disconnect()
            MacroConnection = nil
        end
    end
end

-- ============================================
-- CRIAR PAINEL COM RGB
-- ============================================
local function CreatePanel()
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "ClassicPVPPanel"
    ScreenGui.ResetOnSpawn = false
    ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    GUI = ScreenGui
    
    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.Size = UDim2.new(0, 900, 0, 600)
    MainFrame.Position = UDim2.new(0.5, -450, 0.5, -300)
    MainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
    MainFrame.BorderSizePixel = 0
    MainFrame.Active = true
    MainFrame.Draggable = true
    MainFrame.Parent = ScreenGui
    
    local MainStroke = Instance.new("UIStroke")
    MainStroke.Color = Color3.fromRGB(200, 200, 200)
    MainStroke.Thickness = 3
    MainStroke.Parent = MainFrame
    
    local TitleBar = Instance.new("Frame")
    TitleBar.Size = UDim2.new(1, 0, 0, 50)
    TitleBar.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
    TitleBar.BorderSizePixel = 0
    TitleBar.Parent = MainFrame
    
    local TitleStroke = Instance.new("UIStroke")
    TitleStroke.Color = Color3.fromRGB(200, 200, 200)
    TitleStroke.Thickness = 2
    TitleStroke.Parent = TitleBar
    
    local Title = Instance.new("TextLabel")
    Title.Name = "Title"
    Title.Size = UDim2.new(1, -120, 1, 0)
    Title.Position = UDim2.new(0, 15, 0, 0)
    Title.BackgroundTransparency = 1
    Title.Text = "PANEL PVP CLASSIC MENU 1.0"
    Title.TextColor3 = Color3.fromRGB(255, 255, 255)
    Title.Font = Enum.Font.Code
    Title.TextSize = 18
    Title.TextXAlignment = Enum.TextXAlignment.Left
    Title.Parent = TitleBar
    
    local MinButton = Instance.new("TextButton")
    MinButton.Size = UDim2.new(0, 45, 0, 40)
    MinButton.Position = UDim2.new(1, -95, 0, 5)
    MinButton.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    MinButton.Text = "━"
    MinButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    MinButton.Font = Enum.Font.Code
    MinButton.TextSize = 20
    MinButton.BorderSizePixel = 1
    MinButton.BorderColor3 = Color3.fromRGB(200, 200, 200)
    MinButton.Parent = TitleBar
    
    local CloseButton = Instance.new("TextButton")
    CloseButton.Size = UDim2.new(0, 45, 0, 40)
    CloseButton.Position = UDim2.new(1, -47.5, 0, 5)
    CloseButton.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    CloseButton.Text = "X"
    CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    CloseButton.Font = Enum.Font.Code
    CloseButton.TextSize = 20
    CloseButton.BorderSizePixel = 1
    CloseButton.BorderColor3 = Color3.fromRGB(200, 200, 200)
    CloseButton.Parent = TitleBar
    
    local Sidebar = Instance.new("Frame")
    Sidebar.Size = UDim2.new(0, 200, 1, -50)
    Sidebar.Position = UDim2.new(0, 0, 0, 50)
    Sidebar.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
    Sidebar.BorderSizePixel = 0
    Sidebar.Parent = MainFrame
    
    local SidebarStroke = Instance.new("UIStroke")
    SidebarStroke.Color = Color3.fromRGB(200, 200, 200)
    SidebarStroke.Thickness = 2
    SidebarStroke.Parent = Sidebar
    
    local SidebarLayout = Instance.new("UIListLayout")
    SidebarLayout.Padding = UDim.new(0, 3)
    SidebarLayout.Parent = Sidebar
    
    local ContentFrame = Instance.new("ScrollingFrame")
    ContentFrame.Size = UDim2.new(0, 698, 1, -50)
    ContentFrame.Position = UDim2.new(0, 202, 0, 50)
    ContentFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
    ContentFrame.BorderSizePixel = 0
    ContentFrame.ScrollBarThickness = 6
    ContentFrame.ScrollBarImageColor3 = Color3.fromRGB(200, 200, 200)
    ContentFrame.Visible = false
    ContentFrame.Parent = MainFrame
    
    -- FUNÇÕES DE UI
    local function CreateCategoryButton(name, icon, callback)
        local Button = Instance.new("TextButton")
        Button.Size = UDim2.new(1, 0, 0, 50)
        Button.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
        Button.BorderSizePixel = 1
        Button.BorderColor3 = Color3.fromRGB(50, 50, 50)
        Button.Text = ""
        Button.Parent = Sidebar
        
        local Icon = Instance.new("TextLabel")
        Icon.Size = UDim2.new(0, 30, 1, 0)
        Icon.Position = UDim2.new(0, 10, 0, 0)
        Icon.BackgroundTransparency = 1
        Icon.Text = icon
        Icon.TextColor3 = Color3.fromRGB(255, 255, 255)
        Icon.Font = Enum.Font.Code
        Icon.TextSize = 20
        Icon.Parent = Button
        
        local Label = Instance.new("TextLabel")
        Label.Size = UDim2.new(1, -45, 1, 0)
        Label.Position = UDim2.new(0, 43, 0, 0)
        Label.BackgroundTransparency = 1
        Label.Text = name
        Label.TextColor3 = Color3.fromRGB(255, 255, 255)
        Label.Font = Enum.Font.Code
        Label.TextSize = 16
        Label.TextXAlignment = Enum.TextXAlignment.Left
        Label.Parent = Button
        
        Button.MouseButton1Click:Connect(function()
            ContentFrame.Visible = true
            for _, child in pairs(ContentFrame:GetChildren()) do
                if child:IsA("Frame") and child.Name == "Container" then
                    child:Destroy()
                end
            end
            if callback then
                callback()
            end
        end)
        
        return Button
    end
    
    local function CreateCheckbox(parent, text, settingPath, callback)
        local currentValue = Settings
        for _, key in ipairs(settingPath) do
            currentValue = currentValue[key]
        end
        
        local Frame = Instance.new("Frame")
        Frame.Size = UDim2.new(1, -10, 0, 35)
        Frame.BackgroundTransparency = 1
        Frame.Parent = parent
        
        local Checkbox = Instance.new("TextButton")
        Checkbox.Size = UDim2.new(0, 25, 0, 25)
        Checkbox.Position = UDim2.new(0, 5, 0, 5)
        Checkbox.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
        Checkbox.BorderSizePixel = 2
        Checkbox.BorderColor3 = Color3.fromRGB(200, 200, 200)
        Checkbox.Text = currentValue and "X" or ""
        Checkbox.TextColor3 = Color3.fromRGB(0, 255, 0)
        Checkbox.Font = Enum.Font.Code
        Checkbox.TextSize = 18
        Checkbox.Parent = Frame
        
        local Label = Instance.new("TextLabel")
        Label.Size = UDim2.new(1, -35, 1, 0)
        Label.Position = UDim2.new(0, 35, 0, 0)
        Label.BackgroundTransparency = 1
        Label.Text = text
        Label.TextColor3 = Color3.fromRGB(255, 255, 255)
        Label.Font = Enum.Font.Code
        Label.TextSize = 14
        Label.TextXAlignment = Enum.TextXAlignment.Left
        Label.Parent = Frame
        
        Checkbox.MouseButton1Click:Connect(function()
            local setting = Settings
            for i = 1, #settingPath - 1 do
                setting = setting[settingPath[i]]
            end
            setting[settingPath[#settingPath]] = not setting[settingPath[#settingPath]]
            
            local newValue = setting[settingPath[#settingPath]]
            Checkbox.Text = newValue and "X" or ""
            
            if callback then
                callback(newValue)
            end
        end)
        
        return Frame
    end
    
    local function CreateSlider(parent, text, min, max, settingPath, callback)
        local currentValue = Settings
        for _, key in ipairs(settingPath) do
            currentValue = currentValue[key]
        end
        
        local Frame = Instance.new("Frame")
        Frame.Size = UDim2.new(1, -10, 0, 55)
        Frame.BackgroundTransparency = 1
        Frame.Parent = parent
        
        local Label = Instance.new("TextLabel")
        Label.Size = UDim2.new(1, 0, 0, 20)
        Label.Position = UDim2.new(0, 5, 0, 0)
        Label.BackgroundTransparency = 1
        Label.Text = text .. ": " .. tostring(currentValue)
        Label.TextColor3 = Color3.fromRGB(255, 255, 255)
        Label.Font = Enum.Font.Code
        Label.TextSize = 14
        Label.TextXAlignment = Enum.TextXAlignment.Left
        Label.Parent = Frame
        
        local SliderBG = Instance.new("Frame")
        SliderBG.Size = UDim2.new(1, -10, 0, 8)
        SliderBG.Position = UDim2.new(0, 5, 0, 28)
        SliderBG.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
        SliderBG.BorderSizePixel = 2
        SliderBG.BorderColor3 = Color3.fromRGB(200, 200, 200)
        SliderBG.Parent = Frame
        
        local SliderFill = Instance.new("Frame")
        SliderFill.Size = UDim2.new((currentValue - min) / (max - min), 0, 1, 0)
        SliderFill.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
        SliderFill.BorderSizePixel = 0
        SliderFill.Parent = SliderBG
        
        local SliderButton = Instance.new("TextButton")
        SliderButton.Size = UDim2.new(0, 16, 0, 16)
        SliderButton.Position = UDim2.new((currentValue - min) / (max - min), -8, 0.5, -8)
        SliderButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        SliderButton.BorderSizePixel = 2
        SliderButton.BorderColor3 = Color3.fromRGB(200, 200, 200)
        SliderButton.Text = ""
        SliderButton.Parent = SliderBG
        
        local dragging = false
        
        SliderButton.MouseButton1Down:Connect(function()
            dragging = true
        end)
        
        UserInputService.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = false
            end
        end)
        
        RunService.RenderStepped:Connect(function()
            if dragging then
                local mouse = UserInputService:GetMouseLocation()
                local relativeX = mouse.X - SliderBG.AbsolutePosition.X
                local percentage = math.clamp(relativeX / SliderBG.AbsoluteSize.X, 0, 1)
                local value = math.floor(min + (max - min) * percentage)
                
                local setting = Settings
                for i = 1, #settingPath - 1 do
                    setting = setting[settingPath[i]]
                end
                setting[settingPath[#settingPath]] = value
                
                SliderFill.Size = UDim2.new(percentage, 0, 1, 0)
                SliderButton.Position = UDim2.new(percentage, -8, 0.5, -8)
                Label.Text = text .. ": " .. tostring(value)
                
                if callback then
                    callback(value)
                end
            end
        end)
        
        return Frame
    end
    
    local function CreateDropdown(parent, text, options, settingPath, callback)
        local currentValue = Settings
        for _, key in ipairs(settingPath) do
            currentValue = currentValue[key]
        end
        
        local Frame = Instance.new("Frame")
        Frame.Size = UDim2.new(1, -10, 0, 35)
        Frame.BackgroundTransparency = 1
        Frame.Parent = parent
        
        local Label = Instance.new("TextLabel")
        Label.Size = UDim2.new(0.5, 0, 1, 0)
        Label.Position = UDim2.new(0, 5, 0, 0)
        Label.BackgroundTransparency = 1
        Label.Text = text
        Label.TextColor3 = Color3.fromRGB(255, 255, 255)
        Label.Font = Enum.Font.Code
        Label.TextSize = 14
        Label.TextXAlignment = Enum.TextXAlignment.Left
        Label.Parent = Frame
        
        local DropButton = Instance.new("TextButton")
        DropButton.Size = UDim2.new(0.48, 0, 0, 28)
        DropButton.Position = UDim2.new(0.52, 0, 0, 3.5)
        DropButton.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
        DropButton.BorderSizePixel = 2
        DropButton.BorderColor3 = Color3.fromRGB(200, 200, 200)
        DropButton.Text = currentValue
        DropButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        DropButton.Font = Enum.Font.Code
        DropButton.TextSize = 12
        DropButton.Parent = Frame
        
        local OptionsFrame = Instance.new("Frame")
        OptionsFrame.Size = UDim2.new(0.48, 0, 0, #options * 30)
        OptionsFrame.Position = UDim2.new(0.52, 0, 1, 3)
        OptionsFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
        OptionsFrame.BorderSizePixel = 2
        OptionsFrame.BorderColor3 = Color3.fromRGB(200, 200, 200)
        OptionsFrame.Visible = false
        OptionsFrame.ZIndex = 10
        OptionsFrame.Parent = Frame
        
        local OptLayout = Instance.new("UIListLayout")
        OptLayout.Parent = OptionsFrame
        
        for _, option in ipairs(options) do
            local OptButton = Instance.new("TextButton")
            OptButton.Size = UDim2.new(1, 0, 0, 28)
            OptButton.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
            OptButton.BorderSizePixel = 0
            OptButton.Text = option
            OptButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            OptButton.Font = Enum.Font.Code
            OptButton.TextSize = 12
            OptButton.Parent = OptionsFrame
            
            OptButton.MouseButton1Click:Connect(function()
                local setting = Settings
                for i = 1, #settingPath - 1 do
                    setting = setting[settingPath[i]]
                end
                setting[settingPath[#settingPath]] = option
                
                DropButton.Text = option
                OptionsFrame.Visible = false
                if callback then
                    callback(option)
                end
            end)
        end
        
        DropButton.MouseButton1Click:Connect(function()
            OptionsFrame.Visible = not OptionsFrame.Visible
        end)
        
        return Frame
    end
    
    -- ===== CATEGORIAS =====
    
    -- COMBAT
    CreateCategoryButton("Combat", "⚔", function()
        local Container = Instance.new("Frame")
        Container.Name = "Container"
        Container.Size = UDim2.new(1, 0, 0, 0)
        Container.BackgroundTransparency = 1
        Container.Parent = ContentFrame
        
        local Layout = Instance.new("UIListLayout")
        Layout.Padding = UDim.new(0, 8)
        Layout.Parent = Container
        
        local Padding = Instance.new("UIPadding")
        Padding.PaddingTop = UDim.new(0, 15)
        Padding.PaddingLeft = UDim.new(0, 10)
        Padding.Parent = Container
        
        CreateCheckbox(Container, "Aimbot", {"Combat", "Aimbot"}, function(state) end)
        
        -- Dropdown Type Of Aimbot com KeySelector
        local DropdownFrame = CreateDropdown(Container, "Type Of Aimbot", {"Ao mirar", "ToggleKey"}, {"Combat", "AimbotType"}, function(option)
            -- Mostrar/Esconder KeySelector baseado na opção
            if KeySelectorFrame then
                KeySelectorFrame.Visible = (option == "ToggleKey")
            end
        end)
        
        -- KEY SELECTOR (aparece quando ToggleKey é selecionado)
        local KeySelectorFrame = Instance.new("Frame")
        KeySelectorFrame.Size = UDim2.new(1, -10, 0, 35)
        KeySelectorFrame.BackgroundTransparency = 1
        KeySelectorFrame.Visible = (Settings.Combat.AimbotType == "ToggleKey")
        KeySelectorFrame.Parent = Container
        
        local KeyLabel = Instance.new("TextLabel")
        KeyLabel.Size = UDim2.new(0.5, 0, 1, 0)
        KeyLabel.Position = UDim2.new(0, 5, 0, 0)
        KeyLabel.BackgroundTransparency = 1
        KeyLabel.Text = "Select Key:"
        KeyLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        KeyLabel.Font = Enum.Font.Code
        KeyLabel.TextSize = 14
        KeyLabel.TextXAlignment = Enum.TextXAlignment.Left
        KeyLabel.Parent = KeySelectorFrame
        
        local KeyButton = Instance.new("TextButton")
        KeyButton.Size = UDim2.new(0.48, 0, 0, 28)
        KeyButton.Position = UDim2.new(0.52, 0, 0, 3.5)
        KeyButton.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
        KeyButton.BorderSizePixel = 2
        KeyButton.BorderColor3 = Color3.fromRGB(200, 200, 200)
        KeyButton.Text = "MouseButton2"
        KeyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        KeyButton.Font = Enum.Font.Code
        KeyButton.TextSize = 11
        KeyButton.Parent = KeySelectorFrame
        
        -- Variável para indicar se está aguardando input
        local waitingForInput = false
        local inputConnection = nil
        
        KeyButton.MouseButton1Click:Connect(function()
            if waitingForInput then return end
            
            waitingForInput = true
            KeyButton.Text = "Press any key..."
            KeyButton.BackgroundColor3 = Color3.fromRGB(50, 100, 50)
            
            -- Limpar conexão anterior se existir
            if inputConnection then
                inputConnection:Disconnect()
            end
            
            -- Aguardar qualquer input (tecla do teclado ou botão do mouse)
            inputConnection = UserInputService.InputBegan:Connect(function(input, gameProcessed)
                if not waitingForInput then return end
                
                -- Aceitar QUALQUER input (tecla ou botão do mouse)
                if input.UserInputType == Enum.UserInputType.Keyboard or 
                   input.UserInputType == Enum.UserInputType.MouseButton1 or
                   input.UserInputType == Enum.UserInputType.MouseButton2 or
                   input.UserInputType == Enum.UserInputType.MouseButton3 then
                    
                    -- Salvar a tecla/botão selecionado
                    if input.UserInputType == Enum.UserInputType.Keyboard then
                        Settings.Combat.AimbotKey = input.KeyCode
                        KeyButton.Text = input.KeyCode.Name
                    else
                        Settings.Combat.AimbotKey = input.UserInputType
                        if input.UserInputType == Enum.UserInputType.MouseButton1 then
                            KeyButton.Text = "LeftClick"
                        elseif input.UserInputType == Enum.UserInputType.MouseButton2 then
                            KeyButton.Text = "RightClick"
                        elseif input.UserInputType == Enum.UserInputType.MouseButton3 then
                            KeyButton.Text = "MiddleClick"
                        end
                    end
                    
                    -- Resetar estado
                    waitingForInput = false
                    KeyButton.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
                    
                    -- Desconectar
                    if inputConnection then
                        inputConnection:Disconnect()
                        inputConnection = nil
                    end
                end
            end)
        end)
        CreateCheckbox(Container, "FOV", {"Combat", "FOV"}, function(state)
            if FOVCircle then
                FOVCircle.Visible = state
            end
        end)
        CreateSlider(Container, "FOV Size", 50, 500, {"Combat", "FOVSize"}, function(value)
            if FOVCircle then
                FOVCircle.Radius = value
            end
        end)
        CreateCheckbox(Container, "Hitbox", {"Combat", "Hitbox"}, function(state) end)
        CreateSlider(Container, "Hitbox Size", 5, 50, {"Combat", "HitboxSize"}, function(value) end)
        CreateCheckbox(Container, "No Recoil", {"Combat", "NoRecoil"}, function(state) end)
        CreateCheckbox(Container, "No Hit", {"Combat", "NoHit"}, function(state)
            if state then
                if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                    if not NoHitPart then
                        NoHitPart = Instance.new("Part")
                        NoHitPart.Size = Vector3.new(10, 10, 10)
                        NoHitPart.Transparency = 1
                        NoHitPart.CanCollide = true
                        NoHitPart.Anchored = false
                        NoHitPart.CFrame = LocalPlayer.Character.HumanoidRootPart.CFrame
                        NoHitPart.Parent = workspace
                        
                        local Weld = Instance.new("Weld")
                        Weld.Part0 = NoHitPart
                        Weld.Part1 = LocalPlayer.Character.HumanoidRootPart
                        Weld.C0 = CFrame.new(0, 0, 0)
                        Weld.Parent = NoHitPart
                    end
                end
            else
                if NoHitPart then
                    NoHitPart:Destroy()
                    NoHitPart = nil
                end
            end
        end)
        
        -- DASH BUTTON
        local DashTitle = Instance.new("TextLabel")
        DashTitle.Size = UDim2.new(1, -10, 0, 25)
        DashTitle.BackgroundTransparency = 1
        DashTitle.Text = "Dash Button"
        DashTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
        DashTitle.Font = Enum.Font.Code
        DashTitle.TextSize = 15
        DashTitle.TextXAlignment = Enum.TextXAlignment.Left
        DashTitle.Parent = Container
        
        -- Dash Key Selector
        local DashSelectorFrame = Instance.new("Frame")
        DashSelectorFrame.Size = UDim2.new(1, -10, 0, 35)
        DashSelectorFrame.BackgroundTransparency = 1
        DashSelectorFrame.Parent = Container
        
        local DashLabel = Instance.new("TextLabel")
        DashLabel.Size = UDim2.new(0.5, 0, 1, 0)
        DashLabel.Position = UDim2.new(0, 5, 0, 0)
        DashLabel.BackgroundTransparency = 1
        DashLabel.Text = "Select Dash Key:"
        DashLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        DashLabel.Font = Enum.Font.Code
        DashLabel.TextSize = 14
        DashLabel.TextXAlignment = Enum.TextXAlignment.Left
        DashLabel.Parent = DashSelectorFrame
        
        local DashKeyButton = Instance.new("TextButton")
        DashKeyButton.Size = UDim2.new(0.48, 0, 0, 28)
        DashKeyButton.Position = UDim2.new(0.52, 0, 0, 3.5)
        DashKeyButton.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
        DashKeyButton.BorderSizePixel = 2
        DashKeyButton.BorderColor3 = Color3.fromRGB(200, 200, 200)
        DashKeyButton.Text = "Q"
        DashKeyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        DashKeyButton.Font = Enum.Font.Code
        DashKeyButton.TextSize = 11
        DashKeyButton.Parent = DashSelectorFrame
        
        -- Variável global para tecla do dash
        _G.DashKey = Enum.KeyCode.Q
        
        local waitingForDashInput = false
        local dashInputConnection = nil
        
        DashKeyButton.MouseButton1Click:Connect(function()
            if waitingForDashInput then return end
            
            waitingForDashInput = true
            DashKeyButton.Text = "Press any key..."
            DashKeyButton.BackgroundColor3 = Color3.fromRGB(50, 100, 50)
            
            if dashInputConnection then
                dashInputConnection:Disconnect()
            end
            
            dashInputConnection = UserInputService.InputBegan:Connect(function(input, gameProcessed)
                if not waitingForDashInput then return end
                
                if input.UserInputType == Enum.UserInputType.Keyboard then
                    _G.DashKey = input.KeyCode
                    DashKeyButton.Text = input.KeyCode.Name
                    
                    waitingForDashInput = false
                    DashKeyButton.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
                    
                    if dashInputConnection then
                        dashInputConnection:Disconnect()
                        dashInputConnection = nil
                    end
                end
            end)
        end)
        
        Container.Size = UDim2.new(1, 0, 0, Layout.AbsoluteContentSize.Y)
        ContentFrame.CanvasSize = UDim2.new(0, 0, 0, Layout.AbsoluteContentSize.Y + 30)
    end)
    
    -- ESP COM CHAMS SKIN
    CreateCategoryButton("ESP", "👁", function()
        local Container = Instance.new("Frame")
        Container.Name = "Container"
        Container.Size = UDim2.new(1, 0, 0, 0)
        Container.BackgroundTransparency = 1
        Container.Parent = ContentFrame
        
        local Layout = Instance.new("UIListLayout")
        Layout.Padding = UDim.new(0, 8)
        Layout.Parent = Container
        
        local Padding = Instance.new("UIPadding")
        Padding.PaddingTop = UDim.new(0, 15)
        Padding.PaddingLeft = UDim.new(0, 10)
        Padding.Parent = Container
        
        CreateCheckbox(Container, "ESP", {"ESP", "Enabled"}, function(state) end)
        CreateCheckbox(Container, "ESP Team", {"ESP", "Team"}, function(state) end)
        CreateCheckbox(Container, "Chams", {"ESP", "Chams"}, function(state) end)
        CreateCheckbox(Container, "Chams Team", {"ESP", "ChamsTeam"}, function(state) end)
        CreateCheckbox(Container, "Chams Skin", {"ESP", "ChamsSkin"}, function(state) end)
        CreateCheckbox(Container, "ESP Health", {"ESP", "Health"}, function(state) end)
        CreateCheckbox(Container, "ESP Name", {"ESP", "Name"}, function(state) end)
        CreateCheckbox(Container, "ESP Meters", {"ESP", "Meters"}, function(state) end)
        CreateCheckbox(Container, "ESP Line", {"ESP", "Line"}, function(state) end)
        CreateDropdown(Container, "Place Of Line", {"Top", "Low"}, {"ESP", "LinePlacement"}, function(option) end)
        CreateCheckbox(Container, "ESP Box", {"ESP", "Box"}, function(state) end)
        
        Container.Size = UDim2.new(1, 0, 0, Layout.AbsoluteContentSize.Y)
        ContentFrame.CanvasSize = UDim2.new(0, 0, 0, Layout.AbsoluteContentSize.Y + 30)
    end)
    
    -- COLORS COM RGB
    CreateCategoryButton("Colors", "🎨", function()
        local Container = Instance.new("Frame")
        Container.Name = "Container"
        Container.Size = UDim2.new(1, 0, 0, 0)
        Container.BackgroundTransparency = 1
        Container.Parent = ContentFrame
        
        local Layout = Instance.new("UIListLayout")
        Layout.Padding = UDim.new(0, 8)
        Layout.Parent = Container
        
        local Padding = Instance.new("UIPadding")
        Padding.PaddingTop = UDim.new(0, 15)
        Padding.PaddingLeft = UDim.new(0, 10)
        Padding.Parent = Container
        
        -- Geral Color Of Panel
        local GeneralTitle = Instance.new("TextLabel")
        GeneralTitle.Size = UDim2.new(1, -10, 0, 25)
        GeneralTitle.BackgroundTransparency = 1
        GeneralTitle.Text = "Geral Color Of Panel"
        GeneralTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
        GeneralTitle.Font = Enum.Font.Code
        GeneralTitle.TextSize = 16
        GeneralTitle.TextXAlignment = Enum.TextXAlignment.Left
        GeneralTitle.Parent = Container
        
        local GeneralPreview = Instance.new("Frame")
        GeneralPreview.Size = UDim2.new(0, 40, 0, 40)
        GeneralPreview.Position = UDim2.new(1, -50, 0, 0)
        GeneralPreview.BackgroundColor3 = Settings.Colors.General
        GeneralPreview.BorderSizePixel = 2
        GeneralPreview.BorderColor3 = Color3.fromRGB(200, 200, 200)
        GeneralPreview.Parent = GeneralTitle
        
        local GeneralHex = Instance.new("TextLabel")
        GeneralHex.Size = UDim2.new(1, -10, 0, 20)
        GeneralHex.BackgroundTransparency = 1
        GeneralHex.Text = "#FFFFFF"
        GeneralHex.TextColor3 = Color3.fromRGB(200, 200, 200)
        GeneralHex.Font = Enum.Font.Code
        GeneralHex.TextSize = 12
        GeneralHex.TextXAlignment = Enum.TextXAlignment.Left
        GeneralHex.Parent = Container
        
        local function UpdateGeneralColor()
            local color = Color3.fromRGB(Settings.Colors.GeneralR, Settings.Colors.GeneralG, Settings.Colors.GeneralB)
            Settings.Colors.General = color
            GeneralPreview.BackgroundColor3 = color
            GeneralHex.Text = string.format("#%02X%02X%02X", Settings.Colors.GeneralR, Settings.Colors.GeneralG, Settings.Colors.GeneralB)
            ApplyGeneralColor(color)
        end
        
        CreateSlider(Container, "R (Red)", 0, 255, {"Colors", "GeneralR"}, function(value)
            UpdateGeneralColor()
        end)
        
        CreateSlider(Container, "G (Green)", 0, 255, {"Colors", "GeneralG"}, function(value)
            UpdateGeneralColor()
        end)
        
        CreateSlider(Container, "B (Blue)", 0, 255, {"Colors", "GeneralB"}, function(value)
            UpdateGeneralColor()
        end)
        
        -- Separator
        local Sep = Instance.new("Frame")
        Sep.Size = UDim2.new(1, -10, 0, 2)
        Sep.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
        Sep.BorderSizePixel = 0
        Sep.Parent = Container
        
        -- Panel Color Only
        local PanelTitle = Instance.new("TextLabel")
        PanelTitle.Size = UDim2.new(1, -10, 0, 25)
        PanelTitle.BackgroundTransparency = 1
        PanelTitle.Text = "Panel Color Only"
        PanelTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
        PanelTitle.Font = Enum.Font.Code
        PanelTitle.TextSize = 16
        PanelTitle.TextXAlignment = Enum.TextXAlignment.Left
        PanelTitle.Parent = Container
        
        local PanelPreview = Instance.new("Frame")
        PanelPreview.Size = UDim2.new(0, 40, 0, 40)
        PanelPreview.Position = UDim2.new(1, -50, 0, 0)
        PanelPreview.BackgroundColor3 = Settings.Colors.PanelOnly
        PanelPreview.BorderSizePixel = 2
        PanelPreview.BorderColor3 = Color3.fromRGB(200, 200, 200)
        PanelPreview.Parent = PanelTitle
        
        local PanelHex = Instance.new("TextLabel")
        PanelHex.Size = UDim2.new(1, -10, 0, 20)
        PanelHex.BackgroundTransparency = 1
        PanelHex.Text = "#FFFFFF"
        PanelHex.TextColor3 = Color3.fromRGB(200, 200, 200)
        PanelHex.Font = Enum.Font.Code
        PanelHex.TextSize = 12
        PanelHex.TextXAlignment = Enum.TextXAlignment.Left
        PanelHex.Parent = Container
        
        local function UpdatePanelColor()
            local color = Color3.fromRGB(Settings.Colors.PanelR, Settings.Colors.PanelG, Settings.Colors.PanelB)
            Settings.Colors.PanelOnly = color
            PanelPreview.BackgroundColor3 = color
            PanelHex.Text = string.format("#%02X%02X%02X", Settings.Colors.PanelR, Settings.Colors.PanelG, Settings.Colors.PanelB)
            ApplyPanelOnlyColor(color)
        end
        
        CreateSlider(Container, "R (Red)", 0, 255, {"Colors", "PanelR"}, function(value)
            UpdatePanelColor()
        end)
        
        CreateSlider(Container, "G (Green)", 0, 255, {"Colors", "PanelG"}, function(value)
            UpdatePanelColor()
        end)
        
        CreateSlider(Container, "B (Blue)", 0, 255, {"Colors", "PanelB"}, function(value)
            UpdatePanelColor()
        end)
        
        Container.Size = UDim2.new(1, 0, 0, Layout.AbsoluteContentSize.Y)
        ContentFrame.CanvasSize = UDim2.new(0, 0, 0, Layout.AbsoluteContentSize.Y + 30)
    end)
    
    -- VARIOUS
    CreateCategoryButton("Various", "📦", function()
        local Container = Instance.new("Frame")
        Container.Name = "Container"
        Container.Size = UDim2.new(1, 0, 0, 0)
        Container.BackgroundTransparency = 1
        Container.Parent = ContentFrame
        
        local Layout = Instance.new("UIListLayout")
        Layout.Padding = UDim.new(0, 8)
        Layout.Parent = Container
        
        local Padding = Instance.new("UIPadding")
        Padding.PaddingTop = UDim.new(0, 15)
        Padding.PaddingLeft = UDim.new(0, 10)
        Padding.Parent = Container
        
        CreateCheckbox(Container, "No Clip", {"Various", "NoClip"}, function(state)
            if state then
                NoClipConnection = RunService.Stepped:Connect(function()
                    if Settings.Various.NoClip and LocalPlayer.Character then
                        for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
                            if part:IsA("BasePart") then
                                part.CanCollide = false
                            end
                        end
                    end
                end)
            else
                if NoClipConnection then
                    NoClipConnection:Disconnect()
                    NoClipConnection = nil
                end
            end
        end)
        
        CreateSlider(Container, "WalkSpeed", 16, 200, {"Various", "WalkSpeed"}, function(value)
            WalkSpeedConnection = RunService.Heartbeat:Connect(function()
                if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
                    LocalPlayer.Character.Humanoid.WalkSpeed = Settings.Various.WalkSpeed
                end
            end)
        end)
        
        CreateSlider(Container, "JumpPower", 50, 200, {"Various", "JumpPower"}, function(value)
            JumpPowerConnection = RunService.Heartbeat:Connect(function()
                if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
                    LocalPlayer.Character.Humanoid.JumpPower = Settings.Various.JumpPower
                end
            end)
        end)
        
        CreateCheckbox(Container, "Fly", {"Various", "Fly"}, function(state)
            ToggleFly(state)
        end)
        
        CreateSlider(Container, "Fly Speed", 10, 200, {"Various", "FlySpeed"}, function(value) end)
        
        CreateCheckbox(Container, "Macro", {"Various", "Macro"}, function(state)
            ToggleMacro(state)
        end)
        
        CreateSlider(Container, "Macro Speed", 0.01, 1, {"Various", "MacroSpeed"}, function(value) end)
        
        Container.Size = UDim2.new(1, 0, 0, Layout.AbsoluteContentSize.Y)
        ContentFrame.CanvasSize = UDim2.new(0, 0, 0, Layout.AbsoluteContentSize.Y + 30)
    end)
    
    -- TELEPORT
    CreateCategoryButton("Teleport", "📍", function()
        local Container = Instance.new("Frame")
        Container.Name = "Container"
        Container.Size = UDim2.new(1, 0, 0, 0)
        Container.BackgroundTransparency = 1
        Container.Parent = ContentFrame
        
        local Layout = Instance.new("UIListLayout")
        Layout.Padding = UDim.new(0, 8)
        Layout.Parent = Container
        
        local Padding = Instance.new("UIPadding")
        Padding.PaddingTop = UDim.new(0, 15)
        Padding.PaddingLeft = UDim.new(0, 10)
        Padding.Parent = Container
        
        -- CREATE TELEPORT SECTION
        local CreateTitle = Instance.new("TextLabel")
        CreateTitle.Size = UDim2.new(1, -10, 0, 25)
        CreateTitle.BackgroundTransparency = 1
        CreateTitle.Text = "Create Teleport Point"
        CreateTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
        CreateTitle.Font = Enum.Font.Code
        CreateTitle.TextSize = 16
        CreateTitle.TextXAlignment = Enum.TextXAlignment.Left
        CreateTitle.Parent = Container
        
        -- Nome do Teleport
        local NameFrame = Instance.new("Frame")
        NameFrame.Size = UDim2.new(1, -10, 0, 35)
        NameFrame.BackgroundTransparency = 1
        NameFrame.Parent = Container
        
        local NameLabel = Instance.new("TextLabel")
        NameLabel.Size = UDim2.new(0.35, 0, 1, 0)
        NameLabel.Position = UDim2.new(0, 5, 0, 0)
        NameLabel.BackgroundTransparency = 1
        NameLabel.Text = "Point Name:"
        NameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        NameLabel.Font = Enum.Font.Code
        NameLabel.TextSize = 14
        NameLabel.TextXAlignment = Enum.TextXAlignment.Left
        NameLabel.Parent = NameFrame
        
        local NameInput = Instance.new("TextBox")
        NameInput.Size = UDim2.new(0.63, 0, 0, 28)
        NameInput.Position = UDim2.new(0.37, 0, 0, 3.5)
        NameInput.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
        NameInput.BorderSizePixel = 2
        NameInput.BorderColor3 = Color3.fromRGB(200, 200, 200)
        NameInput.Text = "My Point"
        NameInput.TextColor3 = Color3.fromRGB(255, 255, 255)
        NameInput.Font = Enum.Font.Code
        NameInput.TextSize = 12
        NameInput.ClearTextOnFocus = false
        NameInput.Parent = NameFrame
        
        -- Botão Create
        local CreateButton = Instance.new("TextButton")
        CreateButton.Size = UDim2.new(1, -10, 0, 35)
        CreateButton.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
        CreateButton.BorderSizePixel = 2
        CreateButton.BorderColor3 = Color3.fromRGB(200, 200, 200)
        CreateButton.Text = "Create Teleport"
        CreateButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        CreateButton.Font = Enum.Font.Code
        CreateButton.TextSize = 14
        CreateButton.Parent = Container
        
        CreateButton.MouseButton1Click:Connect(function()
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                local pointName = NameInput.Text
                if pointName == "" then pointName = "Teleport Point" end
                
                -- Criar Part invisível na posição atual
                local teleportPart = Instance.new("Part")
                teleportPart.Size = Vector3.new(4, 1, 4)
                teleportPart.Transparency = 1
                teleportPart.CanCollide = false
                teleportPart.Anchored = true
                teleportPart.CFrame = LocalPlayer.Character.HumanoidRootPart.CFrame
                teleportPart.Name = "TeleportPoint_" .. pointName
                teleportPart.Parent = workspace
                
                -- Salvar ponto
                table.insert(TeleportPoints, {
                    Name = pointName,
                    Part = teleportPart,
                    Button = nil
                })
                
                -- Criar botão para esse ponto
                local TeleportButton = Instance.new("TextButton")
                TeleportButton.Size = UDim2.new(1, -10, 0, 35)
                TeleportButton.BackgroundColor3 = Color3.fromRGB(30, 30, 150)
                TeleportButton.BorderSizePixel = 2
                TeleportButton.BorderColor3 = Color3.fromRGB(200, 200, 200)
                TeleportButton.Text = "📍 " .. pointName
                TeleportButton.TextColor3 = Color3.fromRGB(255, 255, 255)
                TeleportButton.Font = Enum.Font.Code
                TeleportButton.TextSize = 13
                TeleportButton.Parent = Container
                
                -- Salvar referência do botão
                TeleportPoints[#TeleportPoints].Button = TeleportButton
                
                -- Função de teleporte
                TeleportButton.MouseButton1Click:Connect(function()
                    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") and teleportPart.Parent then
                        LocalPlayer.Character.HumanoidRootPart.CFrame = teleportPart.CFrame + Vector3.new(0, 3, 0)
                    end
                end)
                
                -- Botão Delete (clique direito)
                TeleportButton.MouseButton2Click:Connect(function()
                    -- Remover part
                    if teleportPart.Parent then
                        teleportPart:Destroy()
                    end
                    
                    -- Remover botão
                    TeleportButton:Destroy()
                    
                    -- Remover da tabela
                    for i, point in pairs(TeleportPoints) do
                        if point.Part == teleportPart then
                            table.remove(TeleportPoints, i)
                            break
                        end
                    end
                end)
                
                -- Feedback visual
                CreateButton.Text = "✓ Created!"
                CreateButton.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
                task.wait(1)
                CreateButton.Text = "Create Teleport"
                CreateButton.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
                
                -- Limpar nome
                NameInput.Text = "My Point"
                
                -- Atualizar tamanho do container
                Container.Size = UDim2.new(1, 0, 0, Layout.AbsoluteContentSize.Y)
                ContentFrame.CanvasSize = UDim2.new(0, 0, 0, Layout.AbsoluteContentSize.Y + 30)
            end
        end)
        
        -- Separador
        local Separator = Instance.new("Frame")
        Separator.Size = UDim2.new(1, -10, 0, 2)
        Separator.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
        Separator.BorderSizePixel = 0
        Separator.Parent = Container
        
        -- Título da lista
        local ListTitle = Instance.new("TextLabel")
        ListTitle.Size = UDim2.new(1, -10, 0, 25)
        ListTitle.BackgroundTransparency = 1
        ListTitle.Text = "Saved Points (Right-click to delete)"
        ListTitle.TextColor3 = Color3.fromRGB(200, 200, 200)
        ListTitle.Font = Enum.Font.Code
        ListTitle.TextSize = 12
        ListTitle.TextXAlignment = Enum.TextXAlignment.Left
        ListTitle.Parent = Container
        
        Container.Size = UDim2.new(1, 0, 0, Layout.AbsoluteContentSize.Y)
        ContentFrame.CanvasSize = UDim2.new(0, 0, 0, Layout.AbsoluteContentSize.Y + 30)
    end)
    
    -- INFO
    CreateCategoryButton("Info", "ℹ", function()
        local Container = Instance.new("Frame")
        Container.Name = "Container"
        Container.Size = UDim2.new(1, 0, 0, 0)
        Container.BackgroundTransparency = 1
        Container.Parent = ContentFrame
        
        local Layout = Instance.new("UIListLayout")
        Layout.Padding = UDim.new(0, 12)
        Layout.Parent = Container
        
        local Padding = Instance.new("UIPadding")
        Padding.PaddingTop = UDim.new(0, 15)
        Padding.PaddingLeft = UDim.new(0, 15)
        Padding.Parent = Container
        
        local Thumbnail = Instance.new("ImageLabel")
        Thumbnail.Size = UDim2.new(0, 150, 0, 150)
        Thumbnail.Position = UDim2.new(0.5, -75, 0, 0)
        Thumbnail.BackgroundTransparency = 1
        Thumbnail.Image = "https://www.roblox.com/headshot-thumbnail/image?userId=" .. LocalPlayer.UserId .. "&width=150&height=150&format=png"
        Thumbnail.Parent = Container
        
        local Username = Instance.new("TextLabel")
        Username.Size = UDim2.new(1, -20, 0, 25)
        Username.BackgroundTransparency = 1
        Username.Text = "Username: " .. LocalPlayer.Name
        Username.TextColor3 = Color3.fromRGB(255, 255, 255)
        Username.Font = Enum.Font.Code
        Username.TextSize = 14
        Username.TextXAlignment = Enum.TextXAlignment.Left
        Username.Parent = Container
        
        local DisplayName = Instance.new("TextLabel")
        DisplayName.Size = UDim2.new(1, -20, 0, 25)
        DisplayName.BackgroundTransparency = 1
        DisplayName.Text = "Display: " .. LocalPlayer.DisplayName
        DisplayName.TextColor3 = Color3.fromRGB(255, 255, 255)
        DisplayName.Font = Enum.Font.Code
        DisplayName.TextSize = 14
        DisplayName.TextXAlignment = Enum.TextXAlignment.Left
        DisplayName.Parent = Container
        
        local UserID = Instance.new("TextLabel")
        UserID.Size = UDim2.new(1, -20, 0, 25)
        UserID.BackgroundTransparency = 1
        UserID.Text = "UserID: " .. LocalPlayer.UserId
        UserID.TextColor3 = Color3.fromRGB(255, 255, 255)
        UserID.Font = Enum.Font.Code
        UserID.TextSize = 14
        UserID.TextXAlignment = Enum.TextXAlignment.Left
        UserID.Parent = Container
        
        local SessionTime = Instance.new("TextLabel")
        SessionTime.Size = UDim2.new(1, -20, 0, 25)
        SessionTime.BackgroundTransparency = 1
        SessionTime.Text = "Time Using: 00:00:00"
        SessionTime.TextColor3 = Color3.fromRGB(255, 255, 255)
        SessionTime.Font = Enum.Font.Code
        SessionTime.TextSize = 14
        SessionTime.TextXAlignment = Enum.TextXAlignment.Left
        SessionTime.Parent = Container
        
        local Status = Instance.new("TextLabel")
        Status.Size = UDim2.new(1, -20, 0, 25)
        Status.BackgroundTransparency = 1
        Status.Text = "Status: Active"
        Status.TextColor3 = Color3.fromRGB(0, 255, 0)
        Status.Font = Enum.Font.Code
        Status.TextSize = 14
        Status.TextXAlignment = Enum.TextXAlignment.Left
        Status.Parent = Container
        
        local Separator = Instance.new("Frame")
        Separator.Size = UDim2.new(1, -20, 0, 2)
        Separator.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
        Separator.BorderSizePixel = 0
        Separator.Parent = Container
        
        local Made = Instance.new("TextLabel")
        Made.Size = UDim2.new(1, -20, 0, 25)
        Made.BackgroundTransparency = 1
        Made.Text = "Made by Barboza;"
        Made.TextColor3 = Color3.fromRGB(255, 255, 255)
        Made.Font = Enum.Font.Code
        Made.TextSize = 14
        Made.TextXAlignment = Enum.TextXAlignment.Left
        Made.Parent = Container
        
        task.spawn(function()
            while task.wait(1) do
                if SessionTime and SessionTime.Parent then
                    Settings.SessionTime = Settings.SessionTime + 1
                    local h = math.floor(Settings.SessionTime / 3600)
                    local m = math.floor((Settings.SessionTime % 3600) / 60)
                    local s = Settings.SessionTime % 60
                    SessionTime.Text = string.format("Time Using: %02d:%02d:%02d", h, m, s)
                else
                    break
                end
            end
        end)
        
        Container.Size = UDim2.new(1, 0, 0, Layout.AbsoluteContentSize.Y + 170)
        ContentFrame.CanvasSize = UDim2.new(0, 0, 0, Layout.AbsoluteContentSize.Y + 200)
    end)
    
    -- HANDLERS
    CloseButton.MouseButton1Click:Connect(function()
        MainFrame.Visible = false
    end)
    
    local minimized = false
    MinButton.MouseButton1Click:Connect(function()
        minimized = not minimized
        if minimized then
            MainFrame.Size = UDim2.new(0, 900, 0, 50)
        else
            MainFrame.Size = UDim2.new(0, 900, 0, 600)
        end
    end)
    
    ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
    return ScreenGui
end

-- ============================================
-- INICIALIZAÇÃO
-- ============================================

-- Criar FOV Circle
pcall(function()
    FOVCircle = Drawing.new("Circle")
    FOVCircle.Thickness = 1
    FOVCircle.NumSides = 50
    FOVCircle.Radius = Settings.Combat.FOVSize
    FOVCircle.Filled = false
    FOVCircle.Visible = false
    FOVCircle.Color = Color3.new(1, 1, 1)
    FOVCircle.Transparency = 1
    
    RunService.RenderStepped:Connect(function()
        if FOVCircle then
            FOVCircle.Visible = Settings.Combat.FOV
            FOVCircle.Radius = Settings.Combat.FOVSize
            FOVCircle.Position = Vector2.new(Mouse.X, Mouse.Y + 36)
            -- Atualizar cor do FOV de acordo com a cor geral
            FOVCircle.Color = Color3.new(Settings.Colors.General.R, Settings.Colors.General.G, Settings.Colors.General.B)
        end
    end)
end)

-- Criar ESP para TODOS os players (incluindo os que já estão no jogo)
for _, player in pairs(Players:GetPlayers()) do
    if player ~= LocalPlayer then
        CreateESP(player)
    end
end

-- Criar ESP quando NOVOS players entrarem
Players.PlayerAdded:Connect(function(player)
    CreateESP(player)
end)

-- Limpar ESP quando player sair
Players.PlayerRemoving:Connect(function(player)
    if ESPObjects[player] then
        for _, obj in pairs(ESPObjects[player]) do
            if obj then
                if typeof(obj) == "Instance" then
                    obj:Destroy()
                elseif typeof(obj) == "table" then
                    if obj.Remove then obj:Remove() end
                    if obj.Billboard then obj.Billboard:Destroy() end
                end
            end
        end
        ESPObjects[player] = nil
    end
end)

-- Loops principais
RunService.Heartbeat:Connect(function()
    safeCall(UpdateAimbot)
    safeCall(ApplyHitbox)
    safeCall(ApplyNoRecoil)
end)

-- Criar painel
GUI = CreatePanel()

-- Toggle Shift + Z
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    if input.KeyCode == Enum.KeyCode.Z and UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then
        local MainFrame = GUI:FindFirstChild("MainFrame")
        if MainFrame then
            MainFrame.Visible = not MainFrame.Visible
        end
    end
    
    -- DASH KEY
    if input.UserInputType == Enum.UserInputType.Keyboard and input.KeyCode == _G.DashKey then
        PerformDash()
    end
end)

print("╔══════════════════════════════════════════╗")
print("║  PANEL PVP CLASSIC MENU 1.0             ║")
print("║  ✅ VERSÃO FINAL COMPLETA               ║")
print("╠══════════════════════════════════════════╣")
print("║  ✅ RGB Colors (não HSL)                ║")
print("║  ✅ Geral Color muda: Menu+FOV+ESPs     ║")
print("║  ✅ ESP Health: Barra vertical fixa     ║")
print("║  ✅ ESPs aplicam ao entrar/renascer     ║")
print("║  ✅ Chams Skin: Player visível c/ skin  ║")
print("╠══════════════════════════════════════════╣")
print("║  SHIFT + Z: Toggle Panel                ║")
print("║  Made by Barboza                         ║")
print("╚══════════════════════════════════════════╝")
